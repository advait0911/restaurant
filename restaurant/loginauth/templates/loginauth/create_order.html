


{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Create Order</title>
    <link rel="stylesheet" href="{% static 'create_order.css' %}">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
   
    
</head>
<body>

    <h2 class="title">New Order</h2>

    <form action="/orders/new/" id="order_form" method="POST">
        {% csrf_token %}

        <!-- Order Details -->
        <fieldset class="order-details">
            <legend>Order Details</legend>
            <div class="form-group">
                <label>Order Type</label>
                {{ order_form.order_type }}
            </div>
            <div class="form-group">
                <label for="table_number">Table:</label>
                <input type="text" id="table_number" name="table_number" required>
            </div>
            <div class="form-group">
                <label>Waiter</label>
                {{ order_form.waiter }}
            </div>
            <div class="form-group">
                <label>Time</label>
                {{ order_form.order_time }}
            </div>
        </fieldset>

        <!-- Order Items -->
        <fieldset class="order-items">
            <legend>Order Items</legend>

            <!-- Ensure the management form is inside #order-items -->
            <div id="order-items-a">
                {{ formset.management_form }}  

                {% for form in formset %}
                <div class="order-item">
                    
                    
                    
                    <div class="form-group">
    <label>Item Name</label>
    {{ form.item }}
</div>


                    <div class="form-group">
                        <label for="id_quantity">Quantity</label>
                        {{ form.quantity }}
                    </div>
                    
                    <div class="form-group">
                        <label>Notes</label>
                        {{ form.notes }}
                    </div>

                    <div class="form-group">
                        <label for="id_unit_price">Unit Price</label>
                        {{ form.unit_price }}
                    </div>

                    <div class="form-group">
                        <label for="id_gst_rate">GST Rate (%)</label>
                        {{ form.gst_rate }}
                    </div>

                    <div class="form-group">
                        <label for="id_total_price">Total Price</label>
                        {{ form.total_price }}
                    </div>
                </div>
                {% endfor %}
            </div>

            <button type="button"  id="add-item" class="add-btn">+ Add New</button>
        </fieldset>

        <div class="button-group">
            <button type="submit" class="submit-btn">Submit</button>
            <button type="reset" class="reset-btn">Reset</button>
        </div>
    </form>

    <script src="{% static 'create_order.js' %}?v=20" ></script>
    
    {{ price_map|json_script:"item-price-map" }}

<script>
    window.ITEM_PRICE_MAP = JSON.parse(document.getElementById('item-price-map').textContent);
    
</script>
</body>
</html>